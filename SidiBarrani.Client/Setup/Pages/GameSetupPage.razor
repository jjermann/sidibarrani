@page "/gameSetup/{GameIdParam}"

@if (GameSetup == null || GameSetupPageViewModel == null)
{
    <p>Loading...</p>
}
else
{
    <section>
        <h1>@GameSetup.GameName</h1>
        <EditForm Model="@GameSetupPageViewModel"
                  EditContext="@CurrentEditContext"
                  OnValidSubmit="@UpdateGameSetupCommand">
            <div class="form-group row">
                <label for="team1Name"
                       class="col-sm-3">
                </label>
                <InputText id="team1Name"
                           class="form-control col-sm-8"
                           @bind-Value="@GameSetupPageViewModel.Team1Name">
                </InputText>
                <div class="list-group">
                    @if (GameSetup.PlayerGroupSetup.Team1.Player1 != null)
                    {
                        <label class="list-group-item">
                            @GameSetup.PlayerGroupSetup.Team1.Player1.PlayerName
                        </label>
                    }
                    @if (GameSetup.PlayerGroupSetup.Team1.Player2 != null)
                    {
                        <label class="list-group-item">
                            @GameSetup.PlayerGroupSetup.Team1.Player2.PlayerName
                        </label>
                    }
                </div>
            </div>
            <div class="form-group row">
                <label for="team2Name"
                       class="col-sm-3">
                </label>
                <InputText id="team2Name"
                           class="form-control col-sm-8"
                           @bind-Value="@GameSetupPageViewModel.Team1Name">
                </InputText>
                <div class="list-group">
                    @if (GameSetup.PlayerGroupSetup.Team2.Player1 != null)
                    {
                        <label class="list-group-item">
                            @GameSetup.PlayerGroupSetup.Team2.Player1.PlayerName
                        </label>
                    }
                    @if (GameSetup.PlayerGroupSetup.Team2.Player2 != null)
                    {
                        <label class="list-group-item">
                            @GameSetup.PlayerGroupSetup.Team2.Player2.PlayerName
                        </label>
                    }
                </div>
            </div>
            <div>
                <div class="form-group row">
                    <label for="minBet"
                           class="col-sm-3">
                        Mininmal Bet
                    </label>
                    <InputNumber id="minBet"
                                 class="form-control col-sm-8"
                                 @bind-Value="@GameSetupPageViewModel.MinBet">
                    </InputNumber>
                </div>
                <div class="form-group row">
                    <label for="allowUpDown"
                           class="col-sm-3">
                        Allow Upside-Down
                    </label>
                    <InputCheckbox id="allowUpDown"
                                   class="form-control col-sm-8"
                                   @bind-Value="@GameSetupPageViewModel.AllowUpDown">
                    </InputCheckbox>
                </div>
                <div class="form-group row">
                    <label for="endScore"
                           class="col-sm-3">
                        Endscore
                    </label>
                    <InputNumber id="endScore"
                                 class="form-control col-sm-8"
                                 @bind-Value="@GameSetupPageViewModel.EndScore">
                    </InputNumber>
                </div>
            </div>
            @if (GameSetup.HasOpenSpots())
            {
                <button class="btn btn-primary"
                        @onclick="@JoinGameSetupCommand">
                    Join
                </button>
            }
            @if (CurrentEditContext != null && !CurrentEditContext.IsModified())
            {
                <button type="submit"
                        class="btn btn-primary">
                    Update
                </button>
            }
            @if (GameSetup.IsReady())
            {
                <button class="btn btn-primary"
                        @onclick="@StartGameCommand">
                    Start
                </button>
            }
        </EditForm>
    </section>
}